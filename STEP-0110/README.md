
## Неделя 11. CentOS logs and nginx

**Основная часть**

**STEP-111: лог-анализер**

Напишите bash-скрипт, который:

1. Принимает путь к файлу логов (например, `/var/log/messages` или `/var/log/nginx/access.log`).
2. Подсчитывает:
   - общее число записей;
   - число записей за последние N минут (параметр `-n N`);
   - топ-5 наиболее часто встречающихся IP-адресов.
3. Выводит результаты в человекочитаемом виде.

**STEP-112: автоповорот логов**

Напишите bash-скрипт-генератор конфигурации `logrotate`, который:

1. Принимает параметры:
   - путь к лог-файлу;
   - максимальный размер до ротации (например, `100M`);
   - количество хранить архивов.
2. Формирует конфиг-файл в `/etc/logrotate.d/`.
3. Запускает `logrotate` в режиме проверки (`--debug`) для вашей конфигурации.

---

**Факультативная часть**

**STEP-113: агрегатор nginx-логов**

Напишите bash-скрипт, который собирает access- и error-логи всех виртуальных хостов nginx (из `/etc/nginx/sites-enabled/*`), объединяет их в один файл и разбивает по дням, а затем запускает ваш скрипт из STEP-111 для каждого дневного файла.

**STEP-114: мониторинг событий**

Используя `inotifywait`, реализуйте bash-демон, который:

1. Следит за появлением новых записей в логе nginx.
2. При обнаружении в access.log HTTP-кода 5xx или превышения порога по времени ответа (например, >1 сек), отправляет уведомление (на e-mail или в syslog).

---