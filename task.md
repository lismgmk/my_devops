Важно: Первым делом пожалуйста, отправьте свой ключ, чтобы можно было заменить вашу тестовую машину на машину с Centos. Это не мгновенный процесс, поэтому отправьте ключ как можно раньше, чтобы отсутствие тестового окружения вас не блокировало, когда вы займетесь задачками

В этой итерации мы делаем те же задачи по пакетам, что и в 8ой итерации, это повторение, но очень важное. По большей части дистрибутивы Линукс отличаются только пакетным менеджером и нам интересно увидеть разницу и подобие дистрибутивов.

Задание
Основная часть

-----------------------------------

STEP-101 package installer



Нужно написать bash скрипт который будет принимать

- список пакетов для установки

- команду (install/uninstall)

В зависимости от команды устанавливать/удалять пакеты из списка



STEP-102 package upgrader

Нужно написать bash скрипт который будет принимать

- пакет для установки

- желаемую версию

В зависимости от установленной и желаемой версии апгрейдить или даунгрейдить версию пакета 



Факультативная часть

----------------------------------

STEP-103 nginx installation 

Нужно написать bash скрипт который будет устанавливать nginx из официального репозитория nginx https://www.nginx.com/resources/wiki/start/topics/tutorials/install/#official-red-hat-centos-packages



STEP-104 bash packet manager 

Нужно написать простейший пакетный менеджер на баше. Первым аргументом скрипта нужно передавать название пакета. Bash скрипт должен поискать в базе пакетов пакеты с такими названиями и предложить доступные к установке версии. После выбора версии пакета bash скрипт должен установить пакет нужной версии


Ниже предложены задания в том же стиле, что и для 10-й недели, для следующих трёх недель курса.

---

## Неделя 11. CentOS logs and nginx

**Основная часть**

**STEP-111: лог-анализер**

Напишите bash-скрипт, который:

1. Принимает путь к файлу логов (например, `/var/log/messages` или `/var/log/nginx/access.log`).
2. Подсчитывает:
   - общее число записей;
   - число записей за последние N минут (параметр `-n N`);
   - топ-5 наиболее часто встречающихся IP-адресов.
3. Выводит результаты в человекочитаемом виде.

**STEP-112: автоповорот логов**

Напишите bash-скрипт-генератор конфигурации `logrotate`, который:

1. Принимает параметры:
   - путь к лог-файлу;
   - максимальный размер до ротации (например, `100M`);
   - количество хранить архивов.
2. Формирует конфиг-файл в `/etc/logrotate.d/`.
3. Запускает `logrotate` в режиме проверки (`--debug`) для вашей конфигурации.

---

**Факультативная часть**

**STEP-113: агрегатор nginx-логов**

Напишите bash-скрипт, который собирает access- и error-логи всех виртуальных хостов nginx (из `/etc/nginx/sites-enabled/*`), объединяет их в один файл и разбивает по дням, а затем запускает ваш скрипт из STEP-111 для каждого дневного файла.

**STEP-114: мониторинг событий**

Используя `inotifywait`, реализуйте bash-демон, который:

1. Следит за появлением новых записей в логе nginx.
2. При обнаружении в access.log HTTP-кода 5xx или превышения порога по времени ответа (например, >1 сек), отправляет уведомление (на e-mail или в syslog).

---

## Неделя 12. Сетевые настройки

**Основная часть**

**STEP-121: интерфейс менеджер**

Напишите bash-скрипт, который:

1. Принимает имя сетевого интерфейса (например, `eth0`), IP-адрес и маску (пример: `192.168.1.10/24`).
2. Настраивает интерфейс командой `ip addr add` и поднимает его (`ip link set up`).
3. Принимает опциональный параметр — шлюз (`--gw 192.168.1.1`) — и настраивает маршрут по умолчанию.

**STEP-122: резервирование сети**

Напишите bash-скрипт, который проверяет доступность нескольких хостов (список в файле) через `ping` и, если основной шлюз не отвечает, переключает маршрут на альтернативный (второй шлюз).

---

**Факультативная часть**

**STEP-123: firewall-скрипт**

Создайте bash-скрипт для настройки `firewalld` или `iptables`, который:

1. Принимает список портов и протоколов для открытия.
2. Применяет правила, сохраняет их и проверяет, что порты действительно открыты (`ss` или `netstat`).

**STEP-124: DHCP-контроллер**

Реализуйте скрипт, который:

1. С помощью `dnsmasq` конфигурирует DHCP-сервер на указанном интерфейсе.
2. Принимает подсеть, диапазон выдаваемых адресов и время аренды.
3. Пишет конфиг в `/etc/dnsmasq.d/` и перезапускает службу.

---

## Неделя 13. DNS

**Основная часть**

**STEP-131: статический BIND-зонер**

Напишите bash-скрипт, который:

1. Принимает доменное имя, IP-адрес сервера и путь к директории зоны (например, `/var/named/`).
2. Генерирует файл зоны BIND с A- и NS-записями.
3. Добавляет зону в конфиг `named.conf.local` и перезапускает `named`.

**STEP-132: DNS-запросчик**

Напишите утилиту на bash, которая:

1. Принимает домен и тип записи (A, MX, TXT и т. д.).
2. Выполняет запрос через `dig +short` к указанному DNS-серверу (параметр `--server`).
3. Выводит результат с указанием времени ответа (параметр `+time`).

---

**Факультативная часть**

**STEP-133: динамическая обновляемая зона**

Скрипт, который через `nsupdate`:

1. Принимает имя DNS-записи, её новый IP и ключ TSIG.
2. Отправляет динамическое обновление в BIND, проверяет успешность.

**STEP-134: DNS-мониторинг**

С помощью `cron` и вашего скрипта из STEP-132:

1. Периодически проверять доступность и корректность A-записи.
2. При рассогласовании отправлять уведомление на почту.

---

Эти задания покроют работу с логами и nginx, базовые сетевые настройки и DNS-конфигурацию в стиле предыдущей недели.